# Задание:
## Задача 1:
Напишите часть, эмулирующую работу коммутатора, т.е. генерирующую CDR записи.
### Условия:
1.    Во время генерации создаются CDR записи и сохраняются в локальную БД (h2);
2.    Данные генерируются в хронологическом порядке звонков, т.е. записи по одному абоненту могут прерываться записями по другому абоненту;
3.    Количество и длительность звонков определяется случайным образом;
4.    Установленный список абонентов (не менее 10) хранится в локальной БД (h2);
5.    Один прогон генерации создает записи сразу за 1 год.
## Задача 2:
Напишите часть, предоставляющую Rest-API для работы с UDR. 
### Условия:
1.  Требуется REST метод, который возвращает UDR запись (формат предоставлен выше) по одному переданному абоненту. В зависимости от переданных в метод параметров, UDR должен составляться либо за запрошенный месяц, либо за весь тарифицируемый период.
2.  Требуется REST метод, который возвращает UDR записи по всем нашим абонентам за запрошенный месяц.
3.    Данные можно брать только из БД.
# Решение:
Для написания эндпоинтов, описываемых в задании, нужно создать соответствующие сервисы, репозитории и классы - сущности для взаимодейтсвия с базой данных.
В предметной области я выделил несколько классов - сущностей: класс для абонентов - Customer с уникальным идентификатором и самим номером, CdrRecord - класс для хранения данных CDR записи, и UdrRecord - для хранения данных UDR репорта. 
Для нужд реализации в JPA репозиториях классов Customer и CdiRecord я написал кастомные запросы - в том числе для поиска записей по месяцу и пользователю. 
В компоненте CdrGeneratorService я написал логику создания случайного количества записей за год вплоть до настоящего времени (предполагается, что в таблице с абонентами уже существуют записи).
В контроллере UdrController располагаются эндпоинты и логика, связанная с возвращением записи.\
Для запуска сервиса требуется наличие базы данных H2.
#### Эндпоинты:
Маппинг запросов на контроллер осуществляется по адресу/api/udr.\
Эндпоинт /api/udr/getUdrByCustomer/{customerId} -  возвращает репорт по переданному абоненту, а также в зависимости от переданного параметра запроса "month" - если он в пределах от 1 до 12, то возвращает репорт по абоенту за этот месяц, иначе - возвращает репорт по абоненту за все время обслуживания.\
Эндпоинт /api/udr/getUdrsByMonth/{month} - возвращает репорт по всем абонентам за указанный месяц.\
Эндпоинт /api/udr/generate - генерирует CDR записи.
#### Сторонние библиотеки:
Для уменьшения объемов написанного бойлерплейта используется библиотека "Lombok", для подключения к базе данных - библиотека базы данных H2.\
#### Тестирование:
Тестирование выполняется в классе UdrControllerTest. Операции, связанные с базой данных, выполняются в отличной от основной базе данных.